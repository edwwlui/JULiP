## JULiP2 ##

A program for reliable intron selection and for intron-level differential splicing from large collections of RNA-seq data *(manuscript in preparation)*.

Copyright (C) 2017-2019, and GNU GPL v3.0, by Guangyu Yang, Liliana Florea

This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  

### <a name="table-of-contents"></a> Table of contents
- [What is JULiP2?](#what-is-julip)
- [Installation](#installation)
- [Usage](#usage)
- [Input/Output](#inputoutput)
- [Example](#example)
- [Support](#support)

### <a name="what-is-julip"></a> What is JULiP2?
Like its predecessor [JULiP](https://github.com/Guangyu-Yang/JULiP), JULiP2 is a high-performance Python package designed to select an accurate set of introns and, additionally, to perform intron-level differential splicing analysis from large collections of RNA-seq samples.

JULiP2 works on aligned RNA sequencing reads (generated by Tophat or STAR), using a generalized linear model to select a reliable subset of introns from among those extracted from the spliced alignments. JULiP2 assumes a negative binomial model for the intron-supporting read counts, in a maximum likelihood optimization problem.

#### Features  
- Estimates of differential isoform expression for single-end or paired-end RNA-Seq data;  
- Expression estimates at the alternative splicing event (intron) level and at the entire gene level;  
- Confidence intervals for expression estimates and quantitative measures of differential expression;  
- Basic functionality for use on cluster / distributed computing system.

### <a name="installation"></a> Installation
JULiP2 is written in Python and uses the Theano library at the backend. You can install the latest version from this GitHub repository. To download the codes, you can clone this repository by

```
git clone https://github.com/splicebox/JULiP.git
```

#### System requirement
* Linux or Mac  
* Python 2.7   

#### Required Python modules:
* [Theano](http://deeplearning.net/software/theano/), a Python library that define, optimize, and evaluate mathematical expressions involving multi-dimensional arrays.  
* [numpy](www.numpy.org/), a fundamental package for scientific computing with Python  
* [scipy](https://www.scipy.org/), a Python-based package for mathematics, science, and engineering.  
* [statsmodels](http://www.statsmodels.org/stable/index.html), a Python module for the estimation of different statistical models, conducting statistical tests and data exploration.  
* [pysam](https://github.com/pysam-developers/pysam), a Python library for working with SAM/BAM files through samtools.   
* [pathos](https://pypi.python.org/pypi/pathos), a framework for heterogenous computing.  

If you are using pip, install the packages with commands:  
```
pip install --user theano numpy scipy statsmodels pysam pathos
```

#### Other required software:  
* [samtools](http://samtools.sourceforge.net/), for accessing SAM/BAM files

### <a name="usage"></a> Usage
```
Usage: python run.py [options] --bam-file-list bam_file_list.txt

Options:
  --version             show program's version number and exit
  -h, --help            show this help message and exit
  --bam-file-list=BAM_FILE_LIST
                        bam file list
  --annotation=ANNOTATION_FILE
                        path of annotation file (.gtf)
  --out-dir=OUT_DIR     output directory (default: out)
  --seq-name=SEQ_NAME   specify sequence or chromosome name, None for whole
                        sequences.
  --mode=MODE           JULiP processing mode ("differential-analysis" or
                        "intron-detection").
  --threads=THREADS     number of data processing thread. (default: 1)
```

### <a name="inputoutput"></a> Input/Output
The main input of JULiP2 is a list of BAM files with RNA-Seq read mappings.  
As an option, the BAM file can be sorted by genomic location and indexed for random access.  
```
samtools sort -o accepted_hits.sorted.bam accepted_hits.bam
samtools index accepted_hits.sorted.bam
```

### <a name="example"></a> Example
#### Example: run differential analysis model:  
```
REF="path_to_gtf_file"
BAM_LIST="path_to_bam_file_list"
python run.py --bam-file-list $BAM_LIST \              
              --mode 'differential-analysis' \
              --threads 10 \              
              --annotation $REF
```
#### Example: run intron detection model:  
```
python run.py --bam-file-list $BAM_LIST \              
              --mode 'intron-detection' \
              --threads 10 \              
              --annotation $REF
```

### <a name="support"></a> Support
Contact: gyang22@jhu.edu, florea@jhu.edu  

#### License information
See the file LICENSE for information on the history of this software, terms
& conditions for usage, and a DISCLAIMER OF ALL WARRANTIES.
